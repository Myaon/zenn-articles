---
title: "Immersal 1.17.0の変更点（2022/11/04時点）"
emoji: "📰"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["immersal", "ar", "arcore", "arkit"]
published: false
---

# はじめに

:::message
本記事では 2022/11/04 時点の内容をご紹介しています。
アップデート内容は後から変更される可能性がありますのでご了承ください。
:::

## TL;DR

## 概要

日本時間の 2022 年 11 月 2 日に、Immersal SDK やクラウドサービスを含む Immersal サービスの全体が約 8 か月ぶりにアップデートされました。
変更や機能追加などがいろいろあり、個人的には結構びっくりしたので備忘録も兼ねてまとめていきます。

公式ドキュメントの Change Log は以下を参照ください。
本記事では Change Log に書かれていない詳細な情報も取り上げていきます。
https://immersal.gitbook.io/sdk/about/changelog

:::message alert
本記事では筆者の記憶を頼りに新機能だと推測しているものが多分に含まれています。
もし間違いがございましたら[Twitter](https://twitter.com/ninisan_drumath)にご連絡いただくか、記事の GitHub リポジトリに PR を投げていただけますと幸いです。

また、変更内容に抜けがある可能性がございますので、そちらもご連絡いただけますと嬉しいです。
:::

## 対象読者

- Immersal を使ったことがある/知っている方
- Immersal 1.17.0 でどのような変更点があるか気になる方

# 1.17.0 の変更点と現状

## マップビューアでカメラ姿勢の描画をサポート

まずは AR マップビューアから見ていきましょう。
1.17 からのビューアではカメラ姿勢の表示ができるようになっており、
撮影した時にどんな位置でどこを向いていたのがわかるようになっています。

![img](/images/immersal1170-update/map-camera-poses.png)
_カメラ姿勢を表示したときの見え方_

上図は 300 枚のマップのため 300 個のカメラ姿勢が描画されており非常に見づらいものの、軸と一緒に描画されているのでイメージしやすいですね。
この機能ができることによって、どのような足運びで写真を撮影したのかぱっとわかるようになるため、マップ作成のフィードバックができるのではないかと期待しています。
Immersal でそこそこの規模のマップを作成するためには経験とノウハウが必要であり、もしマップが失敗しても原因がわからないこともしばしばで、難しいといわれることがあります。
この機能の登場によって、マップ作成のイテレーションがもっと早くなるといいですね。

## マップビューアで点群サイズや色を変更可能に

次にビューアの小さな変更ですが、Sparse 点群を閲覧するときの点群サイズや色が変更可能になりました。

![img](/images/immersal1170-update/size-normal.png)
_点群サイズ最小_

![img](/images/immersal1170-update/size-big.png)
_点群サイズを大きく_

![img](/images/immersal1170-update/color-tint.png)
_点群の色を緑っぽく_

## メッシュ生成の廃止（2022/11/04 現在）

今回の一番大きなニュースだったと感じたのが、メッシュ生成機能の廃止です。
これまでの Immersal ではマップ作成の際に下記 5 種類のファイルが作成され、ダウンロードして使うことができました。

- Sparse 点群(.ply 点群)
- Dense 点群(.ply メッシュ)
- Textured メッシュ(.glb メッシュ)
- バイナリファイル(.bytes)
- メタデータ(.json)

しかし 1.17.0 がリリースされた現時点では、下記 3 種類のデータのみダウンロードできるように変わっています。

- Sparse 点群
- バイナリファイル
- メタデータ

![img](/images/immersal1170-update/portal-1179.png)
_SDK のバージョンによって DL できるファイルが違う様子_

これはクラウドサービスでの仕様なので、バージョン 1.16.x の Immersal Mapper で作成したマップも同様の結果になると予想されます(未確認)。

今回メッシュ生成機能が廃止になった理由として、公式 Discord ではこのように言われていました。

> None of our paying customers actually use the meshes we generated and we haven't seen much use from free license users either. We had to prioritize development, focus on our core feature set, and ended up cutting mesh generation out from the Cloud Service.

要約すると、Immersal から見るとメッシュ機能が使われている場面が少なく需要はあまりないと判断できたため廃止するということらしいです。
なお次のような文言が強調されて続けられています。

> if you feel meshes were important for your project, please let us know and showcase your work! If there's enough interest in meshes, we can prioritize adding the feature back to our Cloud Service

つまりメッシュ生成機能の需要が高いと判断できれば復活することもありうるということですね。
これを受けて公式 Discord では復活してほしいという意見がとても多く上がっています。

ここからは個人的な見解ですが、筆者もメッシュ生成機能の廃止はとても残念に感じています。
現状のマップだと色付きの特徴点のみによって位置合わせをすることになるのですが、特徴点の分布が均一になることはまれであり、

- 特徴点だけで位置合わせするのはキツイ
  - 特徴点の分布はまばら
  - 広域のマップだと特徴点の密度が低い
- メッシュの使い道はいろいろある
- 固有の機能・感動がある

## REST API

## パフォーマンス向上

## サンプルアプリ

# おわりに

## 雑感

## 参考文献
